{# src/Resources/views/Admin/OptionDependency/create.html.twig #}
{% extends '@SyliusAdmin/Crud/create.html.twig' %}

{% block javascripts %}
    {{ parent() }}
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const parentOptionSelect = document.getElementById('parentOption');
            const parentOptionValueSelect = document.getElementById('parentOptionValue');

            parentOptionSelect.addEventListener('change', function () {
                const optionId = this.value;

                // Vider les options précédentes
                parentOptionValueSelect.innerHTML = '<option value="">Choisissez une valeur</option>';

                if (optionId) {
                    fetch(`/admin/option-dependencies/option-values/${optionId}`)
                        .then(response => response.json())
                        .then(data => {
                            if (data.length > 0) {
                                data.forEach(value => {
                                    const option = document.createElement('option');
                                    option.value = value.id;
                                    option.textContent = value.value;
                                    parentOptionValueSelect.appendChild(option);
                                });
                            }
                        })
                        .catch(error => console.error('Erreur:', error));
                }
            });
        });
    </script>
{% endblock %}
